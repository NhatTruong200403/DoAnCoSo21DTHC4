
@using Microsoft.EntityFrameworkCore.Metadata.Internal
@model DoAnCNTT.Models.Post
@using Microsoft.AspNetCore.Identity

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div>
        <div class="cover-car-container">
            <div class="main-img">
                <div class="cover-car-item">
                    <img loading="lazy" alt=""
                         src="@Model.Image">
                </div>
            </div>
            <div class="sub-img">
                @foreach (var image in @ViewBag.PostImages)
                {
                    <div class="cover-car-item">
                        <img loading="lazy"
                             src="@image"
                             alt="">
                    </div>
                }
            </div>
        </div>
    <div class="cover-car-container" style="margin-top:20px;">
        <div class="main-img">
            <div>
                <span style="font-size:35px;font-weight:bold;">@Html.DisplayFor(model => model.Name)</span>
                <ul style="display:flex;">
                    @{
                        var rideNumber = Model.RideNumber;
                    }

                    @if (rideNumber > 0)
                    {
                        <li style="display:flex;margin-left:-35px;">
                            <img width="24px" src="@Url.Content("~/images/logo/star-s-fill.svg")" alt=""> <div style="margin-top:0px;font-size:18px;margin-right:10px;">5.0</div>
                        </li>
                        
                        <li style="display:flex;">
                            <img width="24px" src="@Url.Content("~/images/logo/luggage-cart-line.svg")" alt=""><div style="margin-top:0px;font-size:18px;margin-right:15px;"> @rideNumber chuyến</div>
                        </li>
                    }
                    else
                    {
                        <li style="margin-left:-35px;">
                            chưa có chuyến
                        </li>
                    }
                    
                    
                    <li >
                        @Html.DisplayFor(model => model.RentLocation)
                    </li>
                </ul>

            </div>
            <hr style="opacity:0.3;" />
            <div>
                <div style="font-weight:bold;">
                    Đặc điểm
                </div>
                <ul class="grid-li">
                    <li>
                        <div><img style="width:35px;" src="@Url.Content("~/images/logo/luggage.png")" /></div>
                        <div>Số chổ</div>
                        <div style="font-weight:bold;">@Html.DisplayFor(model => model.Seat)</div>
                    </li>
                    <li>
                        <div><img style="width:35px;" src="@Url.Content("~/images/logo/gearbox.png")" /></div>
                        <div>Hộp số</div>
                        <div>
                            @if (Model.Gear)
                            {
                                <div style="font-weight:bold;">Số tự động</div>
                            }
                            else
                            {
                                <div style="font-weight:bold;">Số sàn</div>
                            }
                        </div>
                    </li>
                    <li>
                        <div><img style="width:35px;" src="@Url.Content("~/images/logo/fuel.png")" /></div>
                        <div>Nhiên liệu</div>
                        <div style="font-weight:bold;">
                            @Html.DisplayFor(model => model.Fuel)
                        </div>
                    </li>
                    <li>
                        <div><img style="width:35px;" src="@Url.Content("~/images/logo/car-engine.png")" /></div>
                        <div>Nhiên liệu tiêu hao</div>
                        <div style="font-weight:bold;">
                            @Html.DisplayFor(model => model.FuelConsumed) lít/100km
                        </div>
                    </li>
                </ul>
            </div>

            <hr style="opacity:0.3;" />

            <div>
                <div style="font-weight:bold;">Mô tả</div>
                <div>
                    @Html.DisplayFor(model => model.Description)
                </div>
            </div>

            <hr style="opacity:0.3;" />

            <div>
                <div style="font-weight:bold;">
                    Các tiện nghi khác
                </div>
                @* <div>
                    @foreach (var amenity in ViewBag.PostAmenities)
                    {
                        var foundImage = false;
                        foreach (var img in ViewBag.PostIMG)
                        {
                            if (img.Name == amenity.Name)
                            {
                                <img src="@img.IconImage" style="width:20px;" alt="@img.Name" />
                                <span>@amenity.Name</span>
                                foundImage = true;
                                break;
                            }
                        }
                        if (!foundImage)
                        {
                            <div>No image found for @amenity.Name</div>
                        }
                    }
                </div> *@
                <div class="grid-li">
                    @foreach (var amenity in ViewBag.PostAmenities)
                    {
                        var foundImage = false;
                        foreach (var img in ViewBag.PostIMG)
                        {
                            if (img.Name == amenity.Name)
                            {
                                <div class="item" style="padding:10px;">
                                    <img src="@img.IconImage" style="width:24px;margin-right:10px;" alt="@img.Name" />
                                    <span>@amenity.Name</span>
                                </div>
                                foundImage = true;
                                break;
                            }
                        }
                        if (!foundImage)
                        {
                            <div class="item">
                                No image found for @amenity.Name
                            </div>
                        }
                    }
                </div>
            </div>

            <hr style="opacity:0.3;" />

            <div>
                <div style="font-weight:bold;">
                    Giấy tờ thuê xe ?
                </div>
                <div>
                    <div class="flex-container">
                        <div class="small-div"></div>
                        <div class="large-div" style="padding:10px 20px;">
                            <span> ! Chọn 1 trong 2 hình thức</span>
                            <div style="margin-left:10px;margin-block:5px;font-weight:600;">
                                <img style="width:35px;margin-right:10px;" src="@Url.Content("~/images/logo/driving-license.png")" />
                                   GPLX & CCCD gắn chip(Đối chiếu)
                            </div>
                            <div style="margin-left:10px;font-weight:600;">
                                <img style="width:35px;margin-right:10px;" src="@Url.Content("~/images/logo/gplx_passport.png")" />
                                  GPLX(Đối chiếu) & Passport(Giữ lại)
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <div style="font-weight:bold;">
                    Tài sản thế chấp ?
                </div>
                <div>
                    <div class="flex-container">
                        <div class="small-div"></div>
                        <div class="large-div">
                            <span> 15 triệu (tiền mặt/chuyển khoản cho chủ xe khi nhận xe) hoặc Xe máy (kèm cà vẹt gốc) giá trị 15 triệu</span>
                        </div>
                    </div>
                </div>
            </div>



            <div>
                <div>Điều khoản</div>
            </div>

            <div>
                <div>
                    Chính sách hủy chuyến
                </div>
            </div>











            <hr style="opacity:0.3;" />
            <div>
                @{
                    var user = await UserManager.GetUserAsync(User);
                }
                <span>Chủ xe</span>
                <div style="display:flex;">
                    <img src="@Url.Content(user.Image)" style="width:70px;height:70px;border-radius:50%;" />
                    <div style="margin-left:20px;">
                        <span style="font-weight:bold;font-size:25px;">@user.Name</span>
                        <div>
                            <i>
                                @if (rideNumber > 0)
                                {
                                    <div style="display:flex;">
                                        <li style="margin-right:10px;">
                                            5.0
                                        </li>
                                        <li>
                                            @rideNumber chuyến
                                        </li>
                                    </div>
                                }
                                else
                                {
                                    <li style="">
                                        chưa có chuyến
                                    </li>
                                }
                            </i>
                        </div>
                    </div>
                    
                </div>
                <div>
                    <ul class="grid-li">
                        <li>
                            <div>
                                Tỉ lệ phản hồi
                            </div>
                            <div>
                                100%
                            </div>
                        </li>
                        <li>
                            <div>
                                Thời gian phản hồi
                            </div>
                            <div>
                                5 phút
                            </div>
                        </li>
                        <li>
                            <div>
                                Tỉ lệ đồng ý
                            </div>
                            <div>
                                100%
                            </div>
                        </li>
                    </ul>
                </div>
            </div>


            <div>
                Đánh giá

                <div class="comment">

                   @*  @foreach (var amenity in ViewBag.Comment)
                    {
                        var cmt = false;
                        foreach (var img in ViewBag.Cmt)
                        {
                            if (img. == amenity.Name)
                            {
                                <div class="item" style="padding:10px;">
                                    <img src="@img.IconImage" style="width:24px;margin-right:10px;" alt="@img.Name" />
                                    <span>@amenity.Name</span>
                                </div>
                                foundImage = true;
                                break;
                            }
                        }
                    } *@



                    @for (int i = 0; i < ViewBag.Comment.Count; i++)
                    {
                    <div class="comment-avatar">
                        <img src="~/images/ImageUser/user.png" alt="hinhanh.jpg" />
                    </div>
                        <div class="comment-content">
                            <div class="rating">
                                @for (int j = 0; j < ViewBag.Star[i]; j++)
                                {
                                    if(ViewBag.Star[i]==1)
                                    {
                                        <span class="star">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        break;
                                    }
                                    else if (ViewBag.Star[i]== 2)
                                    {
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        break;
                                    }
                                    else if (ViewBag.Star[i] == 3)
                                    {
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        break;
                                    }
                                    else if (ViewBag.Star[i] == 4)
                                    {
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star-none">&#9733;</span>
                                        break;
                                    }
                                    else if(ViewBag.Star[i] == 5)
                                    {
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        <span class="star">&#9733;</span>
                                        break;
                                    }
                                }
                            </div>
                            <p class="comment-text">@ViewBag.Comment[i]</p>
                        </div>
                    }
                </div>
            <!-- <div>
                <partial name ="AddComment"  />
            </div> -->

            </div>





            </div>
        <div class="sub-img">Trống</div>
        </div>
    
</div>
<div>
    @{
        var currentUser = await UserManager.GetUserAsync(User);
        if(SignInManager.IsSignedIn(User))
        {
            if (currentUser!.Id == Model.UserId)
            {
                <a asp-action="Edit" asp-route-id="@Model?.Id">Chỉnh sửa</a>
            }
        }
    }

    <a asp-area="Customer" asp-controller="Bookings" asp-action="Create" asp-route-userId="@Model?.UserId" asp-route-postId="@Model?.Id">Đặt cọc</a> |
    <a href="javascript:history.go(-1);">Quay lại</a>
</div>




<style>
    .flex-container {
        display: flex;
    }

    .small-div {
        flex: 0 0 1%;
        background-color: #f26a2b; /* Màu nền của div đầu tiên */
        border-top-left-radius: 10px; /* Độ cong góc trái trên */
        border-bottom-left-radius: 10px; /* Độ cong góc trái dưới */
    }

    .large-div {
        flex: 0 0 99%;
        background-color: #fef7f0;
    }
    .grid-li {
        display: grid;
        grid-template-columns: repeat(4, 1fr); /* 4 cột bằng nhau */
        gap: 10px; /* Khoảng cách giữa các cột */
    }
    .cover-car-container {
        display: flex;
        position: relative;
        grid-gap: 16px;
        gap: 16px;
        width: 100%;
    }

        .cover-car-container .main-img {
            position: relative;
            width: calc(68% - 16px);
            height: 100%;
        }

        .cover-car-container .sub-img {
            width: 32%;
            height: 100%;
            display: flex;
            flex-direction: column;
            grid-gap: 16px;
            gap: 16px;
        }

            .cover-car-container .sub-img img {
                height: 176px;
            }
    .cover-car-item {
        cursor: pointer;
    }

    .cover-car-item img {
    width: 100%;
    height: 560px;
    border-radius: 16px;
    object-fit: cover;
}
    .comment-item {
        display: flex;
        margin-bottom: 20px;
    }

    .comment-avatar img {
        width: 50px;
        height: 50px;
        border-radius: 50%;
    }

    .comment-content {
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        margin-left: 10px;
    }

        .comment-content .rating {
            font-size: 20px;
        }

        .comment-content .star {
            color: #FFD700;
            display: inline-block;
        }

        .comment-content .star-none{
            color: none;
            display: inline-block;
        }

        .comment-content .comment-text {
            margin-top: 5px;
            font-size: 14px;
        }
</style>
